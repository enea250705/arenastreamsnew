!function(){'use strict';var a=function(){var b=document.getElementById('mobile-menu-btn'),c=document.getElementById('mobile-menu');b&&c&&b.addEventListener('click',function(){c.classList.toggle('hidden')})};document.addEventListener('DOMContentLoaded',a);async function d(e,f){try{console.log(`ğŸ”„ Loading ${e} matches from Streamed.pk...`);const g=await fetch(`/api/streamed/matches/${e}`),h=await g.json();let i=[];h.value&&Array.isArray(h.value)?i=h.value:Array.isArray(h)&&(i=h);if(0<i.length){const j=i.map(a=>{let b='Team A',c='Team B',d='',e='';if(a.teams&&a.teams.home&&a.teams.away){b=a.teams.home.name||'Team A',c=a.teams.away.name||'Team B',d=a.teams.home.badge?`https://streamed.pk/api/images/badge/${a.teams.home.badge}.webp`:'',e=a.teams.away.badge?`https://streamed.pk/api/images/badge/${a.teams.away.badge}.webp`:''}else if(a.title){if(a.title.includes(' vs ')){const d=a.title.split(' vs ');2===d.length?(b=d[0].trim(),c=d[1].trim()):(b=a.title,c='vs Opponent')}else if(a.title.includes(':')){const d=a.title.indexOf(':'),e=a.title.substring(d+1).trim();e.includes(' vs ')?(f=e.split(' vs '),2===f.length?(b=f[0].trim(),c=f[1].trim()):(b=e,c='vs Opponent')):(b=e,c='vs Opponent')}else b=a.title,c='vs Opponent'}let g;if(a.date&&0<a.date)g=new Date(a.date).toISOString();else{const b=new Date;b.setHours(b.getHours()+2),g=b.toISOString()}const h=`${b}-vs-${c}-live-${new Date(g).toISOString().split('T')[0]}`.toLowerCase().replace(/[^a-z0-9-]/g,'-');return{id:a.id,teamA:b,teamB:c,competition:a.title||`${e.charAt(0).toUpperCase()+e.slice(1)} Match`,date:g,slug:h,teamABadge:d,teamBBadge:e,status:function(a){const b=new Date,c=a&&0<a?new Date(a):(new Date).setHours((new Date).getHours()+2);const d=(c-b)/(1e3*60);return-90>d?'ended':0>d?'live':30>d?'starting-soon':'upcoming'}(a.date),poster:a.poster?`https://streamed.pk/api/images/poster/${a.poster}`:'',popular:a.popular||!1,sources:a.sources||[],category:a.category||e}});console.log(`ğŸ“Š Found ${j.length} ${e} matches from Streamed.pk`);return j}console.log(`âš ï¸ No ${e} matches found in Streamed.pk`);return[]}catch(a){console.error(`âŒ Error loading ${e} matches from Streamed.pk:`,a);return[]}}async function e(){try{console.log('ğŸ”´ Loading live matches from Streamed.pk...');const a=await fetch('/api/streamed/matches/live'),b=await a.json();let c=[];b.value&&Array.isArray(b.value)?c=b.value:Array.isArray(b)&&(c=b);if(0<c.length){const d=c.map(a=>{let b='Team A',c='Team B',d='',e='';if(a.teams&&a.teams.home&&a.teams.away){b=a.teams.home.name||'Team A',c=a.teams.away.name||'Team B',d=a.teams.home.badge?`https://streamed.pk/api/images/badge/${a.teams.home.badge}.webp`:'',e=a.teams.away.badge?`https://streamed.pk/api/images/badge/${a.teams.away.badge}.webp`:''}else if(a.title){const d=a.title.split(' vs ');2===d.length?(b=d[0].trim(),c=d[1].trim()):(b=a.title,c='vs Opponent')}const f=`${b}-vs-${c}-live-${new Date(a.date).toISOString().split('T')[0]}`.toLowerCase().replace(/[^a-z0-9-]/g,'-');return{id:a.id,teamA:b,teamB:c,competition:a.title||'Live Match',date:new Date(a.date).toISOString(),slug:f,teamABadge:d,teamBBadge:e,status:'live',poster:a.poster?`https://streamed.pk/api/images/poster/${a.poster}`:'',popular:a.popular||!1,sources:a.sources||[],category:a.category||'live'}});console.log(`ğŸ”´ Found ${d.length} live matches from Streamed.pk`);return d}console.log('âš ï¸ No live matches found in Streamed.pk');return[]}catch(a){console.error('âŒ Error loading live matches from Streamed.pk:',a);return[]}}function f(a){const b=new Date;let c;a&&0<a?c=new Date(a):(c=new Date,c.setHours(c.getHours()+2));const d=(c-b)/(1e3*60);return-90>d?'ended':0>d?'live':30>d?'starting-soon':'upcoming'}function g(a,b=15){if(a.length<=b)return a;const c=a.substring(0,b),d=c.lastIndexOf(' ');return d>b*0.6?c.substring(0,d)+'...':c+'...'}function h(a){return 640>window.innerWidth?g(a,10):g(a,18)}let i=[],j;function k(a,b){if(typeof gtag!=='undefined')gtag('event',a,{event_category:b,event_label:arguments[2],value:arguments[3]})}function l(a,b,c,d){k('match_click','Match Interaction',`${b} vs ${c}`,1)}function m(a,b,c){k('stream_play','Streaming',`${b} vs ${c}`,1)}function n(a,b){k('search_usage','Search',a,b)}function o(a,b){console.log(`ğŸ” Searching for "${a}" in container ${b} with ${i.length} matches`);if(!a.trim())return void console.log('ğŸ” Empty search, showing all matches'),p(i,b);const c=i.filter(e=>{const d=a.toLowerCase(),f=e.teamA?e.teamA.toLowerCase():'',g=e.teamB?e.teamB.toLowerCase():'',h=e.competition?e.competition.toLowerCase():'',i=e.title?e.title.toLowerCase():'';const j=f.includes(d)||g.includes(d)||h.includes(d)||i.includes(d);return j&&console.log(`âœ… Match found: ${f} vs ${g}`),j});console.log(`ğŸ¯ Found ${c.length} matches for "${a}"`),p(c,b),n(a,c.length);const d=document.getElementById(b);d&&d.previousElementSibling&&(e=>{const f=d.previousElementSibling.querySelector('.search-results-info');f&&(f.textContent=`Found ${e} match${1!==e?'es':''} for "${a}"`,f.style.display='block')})(c.length)}function p(a,b){const c=document.getElementById(b);if(!c)return;0===a.length?(c.innerHTML='<div class="text-center py-8"><div class="text-4xl mb-4">ğŸŸï¸</div><h3 class="text-xl font-semibold mb-2">No matches available</h3><p class="text-gray-400">Check back later for upcoming matches</p></div>'):(c.innerHTML=a.map(a=>`<div class="bg-dark border border-gray-800 rounded-lg p-3 sm:p-6 hover:border-primary transition-colors"><div class="mb-3 sm:mb-4">${'vs Opponent'!==a.teamB?`<div class="flex items-center justify-between space-x-2"><div class="flex items-center space-x-2 min-w-0 flex-1">${a.teamABadge?`<img src="${a.teamABadge}" alt="${a.teamA}" class="w-5 h-5 sm:w-8 sm:h-8 rounded-full flex-shrink-0" onerror="this.style.display='none'">`:' '}<span class="font-semibold text-xs sm:text-base truncate" title="${a.teamA}">${h(a.teamA)}</span></div><span class="text-primary font-bold text-xs sm:text-sm flex-shrink-0">VS</span><div class="flex items-center space-x-2 min-w-0 flex-1 justify-end"><span class="font-semibold text-xs sm:text-base truncate" title="${a.teamB}">${h(a.teamB)}</span>${a.teamBBadge?`<img src="${a.teamBBadge}" alt="${a.teamB}" class="w-5 h-5 sm:w-8 sm:h-8 rounded-full flex-shrink-0" onerror="this.style.display='none'">`:' '}</div></div>`:`<div class="flex items-center justify-between"><div class="flex items-center space-x-2 min-w-0 flex-1">${a.teamABadge?`<img src="${a.teamABadge}" alt="${a.teamA}" class="w-5 h-5 sm:w-8 sm:h-8 rounded-full flex-shrink-0" onerror="this.style.display='none'">`:' '}<span class="font-semibold text-xs sm:text-base truncate" title="${a.teamA}">${h(a.teamA)}</span></div><span class="text-gray-400 text-xs flex-shrink-0">Live</span></div>`}</div><div class="text-center mb-4"><p class="text-gray-400 text-xs sm:text-sm mb-1">${a.competition}</p><p class="text-gray-300 text-xs sm:text-sm mb-2">${new Date(a.date).toLocaleString()}</p>${'live'===a.status?'<span class="inline-block bg-red-500 text-white text-xs px-2 py-1 rounded-full">LIVE</span>':''}${'starting-soon'===a.status?'<span class="inline-block bg-yellow-500 text-dark text-xs px-2 py-1 rounded-full">Starting Soon</span>':''}${'ended'===a.status?'<span class="inline-block bg-gray-500 text-white text-xs px-2 py-1 rounded-full">Ended</span>':''}${'upcoming'===a.status?'<span class="inline-block bg-blue-500 text-white text-xs px-2 py-1 rounded-full">Upcoming</span>':''}</div><a href="/match/${a.slug}" class="block w-full bg-primary text-dark font-bold py-2 sm:py-3 px-3 sm:px-4 rounded-lg text-center hover:bg-yellow-400 transition-colors text-sm sm:text-base" onclick="l('${a.id}','${a.teamA}','${a.teamB}','${a.competition}')">${'live'===a.status?'Watch Live':'starting-soon'===a.status?'Watch Soon':'Watch Stream'}</a></div>`).join(''),function(a){const b=a.filter(a=>'live'===a.status).length;document.querySelectorAll('#live-count').forEach(a=>{a.textContent=b});const a=document.querySelector('[data-match-count]');a&&(a.textContent=a.length),console.log(`ğŸ“Š Updated live match count: ${b} live matches, ${a.length} total matches`)}(a))}function q(a,b){i=a,b&&o('',b)}function r(a){const b=document.getElementById(a);if(!b)return void console.log(`âŒ Container ${a} not found`);document.getElementById(`search-input-${a}`)&&console.log(`âœ… Search input already exists for ${a}`);const c=`<div class="mb-4"><div class="relative"><input type="text" id="search-input-${a}" class="w-full px-4 py-2 pl-10 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:border-primary focus:outline-none transition-colors" placeholder="${arguments[1]||'Search teams or matches...'}" autocomplete="off"><div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></div><button id="clear-search-${a}" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-white transition-colors" style="display: none;"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div><div class="search-results-info text-sm text-gray-400 mt-2" style="display: none;"></div></div>`;b.insertAdjacentHTML('beforebegin',c);const d=document.getElementById(`search-input-${a}`),e=document.getElementById(`clear-search-${a}`);if(!d)return void console.log(`âŒ Failed to create search input for ${a}`);console.log(`âœ… Search input created for ${a}`),d.addEventListener('input',function(){const a=this.value.trim();console.log(`ğŸ” Search input changed: "${a}"`),e&&(e.style.display=a?'flex':'none'),clearTimeout(j),j=setTimeout(()=>{o(a,b)},300)}),e&&e.addEventListener('click',function(){d.value='',this.style.display='none',o('',b),d.focus()}),console.log(`ğŸ¯ Search initialization complete for ${a}`)}function s(a,b,c="Search teams or matches..."){console.log(`ğŸ” Initializing search for container: ${a} with ${b.length} matches`),q(b,a),r(a,c),p(b,a),console.log(`âœ… Search initialized for ${a}, stored ${i.length} matches`)}window.ArenaStreams={loadSportMatches:d,loadLiveMatches:e,renderMatches:p,renderMatchesWithSearch:s,searchMatches:o,initializeSearch:r,getMatchStatus:f,setupAutoRefresh:async function(a,b,c){try{console.log(`ğŸ”„ Setting up auto-refresh for ${a}...`),console.log(`ğŸ“Š Container ID: ${b}, No Matches ID: ${c}`);const d=document.getElementById(b);if(!d)return void console.error(`âŒ Container ${b} not found!`);console.log(`âœ… Container ${b} found`),await function(a,b,c){try{console.log(`ğŸ”„ Loading ${a} matches...`);const d=await d(a);console.log(`ğŸ“Š Loaded ${d.length} matches for ${a}`),0<d.length?(console.log(`ğŸ¯ Rendering ${d.length} matches in container ${b}`),s(d,b,`Search ${a} matches...`),document.getElementById(c)&&document.getElementById(c).classList.add('hidden')&&console.log(`âœ… Hidden no-matches message`)):(console.log(`âš ï¸ No matches found, showing no-matches message`),document.getElementById(c)&&(document.getElementById(c).classList.remove('hidden'),console.log(`âœ… Showed no-matches message`)))}catch(a){console.error(`âŒ Error loading ${a} matches:`,a)}}(a,b,c),setInterval(async()=>{document.hidden||(console.log(`ğŸ”„ Auto-refreshing ${a} matches...`),await function(a,b,c){try{console.log(`ğŸ”„ Loading ${a} matches...`);const d=await d(a);console.log(`ğŸ“Š Loaded ${d.length} matches for ${a}`),0<d.length?(console.log(`ğŸ¯ Rendering ${d.length} matches in container ${b}`),s(d,b,`Search ${a} matches...`),document.getElementById(c)&&document.getElementById(c).classList.add('hidden')&&console.log(`âœ… Hidden no-matches message`)):(console.log(`âš ï¸ No matches found, showing no-matches message`),document.getElementById(c)&&(document.getElementById(c).classList.remove('hidden'),console.log(`âœ… Showed no-matches message`)))}catch(a){console.error(`âŒ Error loading ${a} matches:`,a)}}(a,b,c))},120000)}catch(a){console.error(`âŒ Error setting up auto-refresh for ${a}:`,a)}},loadAndRenderSportMatches:async function(a,b,c){try{console.log(`ğŸ”„ Loading ${a} matches...`);const d=await d(a);console.log(`ğŸ“Š Loaded ${d.length} matches for ${a}`),0<d.length?(console.log(`ğŸ¯ Rendering ${d.length} matches in container ${b}`),s(d,b,`Search ${a} matches...`),document.getElementById(c)&&document.getElementById(c).classList.add('hidden')&&console.log(`âœ… Hidden no-matches message`)):(console.log(`âš ï¸ No matches found, showing no-matches message`),document.getElementById(c)&&(document.getElementById(c).classList.remove('hidden'),console.log(`âœ… Showed no-matches message`)))}catch(a){console.error(`âŒ Error loading ${a} matches:`,a)}}};
